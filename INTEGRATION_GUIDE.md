# üîó –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π

## üìã –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ webhook —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

### üåê URL –≤–∞—à–µ–π —Ä—É—á–∫–∏
```
http://85.192.56.74:5000/api/payment
```

### üîë Auth Bearer —Ç–æ–∫–µ–Ω
–¢–æ–∫–µ–Ω –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å —Å–≤–æ–π:
```
your-secure-token-here
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –ù–∞ Windows:
```cmd
install_webhook.bat
python webhook_server.py
```

### –ù–∞ Linux (Ubuntu 20.04):
```bash
chmod +x install_webhook.sh
sudo ./install_webhook.sh
```

## üì° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–∞—à URL
2. **–í–∞—à —Å–µ—Ä–≤–µ—Ä** –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (amount, orderId)
3. **–°–æ–∑–¥–∞–µ—Ç—Å—è –ø–ª–∞—Ç–µ–∂** —á–µ—Ä–µ–∑ API elecsnet.ru
4. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è QR-–∫–æ–¥** –¥–ª—è –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –°–ë–ü

## üìä –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

**POST** `http://85.192.56.74:5000/api/payment`

**Headers:**
```
Authorization: Bearer your-token
Content-Type: application/json
```

**Body:**
```json
{
    "amount": 100,
    "orderId": "order-id-hash"
}
```

## üìã –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

**Success (200):**
```json
{
    "success": true,
    "orderId": "order-id-hash",
    "qrcId": "BR10006J6N78356E9GC8D5BANTAT1HIV",
    "qr": "https://qr.nspk.ru/..."
}
```

**Error (400/401/500):**
```json
{
    "success": false,
    "error": "Error description"
}
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `webhook_config.py`:

```python
# –í–∞—à–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
CARD_NUMBER = "9860100125857258"  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã
CARD_OWNER = "IZZET SAMEKEEV"     # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–∞—Ä—Ç—ã
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   python webhook_server.py
   ```

2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API:**
   ```bash
   python test_webhook.py
   ```

3. **–†—É—á–Ω–æ–π —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ curl:**
   ```bash
   curl -X POST http://85.192.56.74:5000/api/payment \
     -H "Authorization: Bearer your-token" \
     -H "Content-Type: application/json" \
     -d '{"amount": 1000, "orderId": "test-123"}'
   ```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–°–º–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω** –≤ `webhook_config.py` –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ firewall

## üìû Callback –æ—Ç –ù–°–ü–ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç callback –æ—Ç –ù–°–ü–ö, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ endpoint:

**POST** `http://85.192.56.74:5000/webhook/nspk`

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤.

## üîÑ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
curl http://85.192.56.74:5000/api/health
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞:
```bash
curl -H "Authorization: Bearer your-token" \
     http://85.192.56.74:5000/api/status/order-id
```

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤:
- –ö–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞
- –§–∞–π–ª `webhook.log` (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ (–¥–ª—è Linux —Å–µ—Ä–≤–∏—Å–∞)

## ‚ùì Troubleshooting

### –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: `python webhook_server.py`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç 5000: `netstat -an | grep 5000`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall: `ufw status`

### –û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç: `Bearer your-token`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `webhook_config.py`

### –û—à–∏–±–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å elecsnet.ru
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pip install -r requirements.txt`)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –≤ `webhook_config.py`
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ç–æ–∫–µ–Ω
- [ ] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/api/health`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `test_webhook.py`
- [ ] –ü–µ—Ä–µ–¥–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É:
  - [ ] URL: `http://85.192.56.74:5000/api/payment`
  - [ ] Token: `your-actual-token`

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å QR-–∫–æ–¥—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã.