<!DOCTYPE html>
<html lang="ru" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkFlow Admin</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.lucide) lucide.createIcons();
        });
        
        document.addEventListener('alpine:initialized', () => {
            setTimeout(() => {
                if (window.lucide) lucide.createIcons();
            }, 100);
        });
    </script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                        pixel: ['Press Start 2P', 'cursive'],
                    }
                }
            }
        }
    </script>
    
    <style>
        [x-cloak] { display: none !important; }
        
        .glass {
            background: rgba(17, 17, 17, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .pixel-corners {
            clip-path: polygon(
                0 4px, 4px 4px, 4px 0,
                calc(100% - 4px) 0, calc(100% - 4px) 4px, 100% 4px,
                100% calc(100% - 4px), calc(100% - 4px) calc(100% - 4px), calc(100% - 4px) 100%,
                4px 100%, 4px calc(100% - 4px), 0 calc(100% - 4px)
            );
        }
        
        .pixel-border {
            position: relative;
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
        }
        
        .pixel-border::before {
            content: '';
            position: absolute;
            inset: 0;
            padding: 2px;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.05));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            clip-path: polygon(
                0 4px, 4px 4px, 4px 0,
                calc(100% - 4px) 0, calc(100% - 4px) 4px, 100% 4px,
                100% calc(100% - 4px), calc(100% - 4px) calc(100% - 4px), calc(100% - 4px) 100%,
                4px 100%, 4px calc(100% - 4px), 0 calc(100% - 4px)
            );
        }
        
        .scanlines {
            position: relative;
            overflow: hidden;
        }
        
        .scanlines::after {
            content: '';
            position: absolute;
            inset: 0;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15) 0px,
                transparent 1px,
                transparent 2px,
                rgba(0, 0, 0, 0.15) 3px
            );
            pointer-events: none;
            animation: scan 8s linear infinite;
        }
        
        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(4px); }
        }
        
        .pixel-shadow {
            box-shadow: 
                4px 0 0 rgba(255,255,255,0.1),
                0 4px 0 rgba(0,0,0,0.5),
                4px 4px 0 rgba(0,0,0,0.3);
        }
        
        .retro-glow {
            text-shadow: 
                0 0 10px rgba(255,255,255,0.5),
                0 0 20px rgba(255,255,255,0.3),
                0 0 30px rgba(255,255,255,0.1);
        }
        
        .hover-lift {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.1);
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #111;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="bg-black text-white font-sans antialiased" x-data="adminApp()" x-cloak>

    <!-- Sidebar -->
    <aside class="fixed left-0 top-0 h-screen w-64 glass border-r border-white/10 z-50 flex flex-col">
        <!-- Logo -->
        <div class="p-6 border-b border-white/10">
            <div class="flex items-center gap-3 mb-1">
                <div class="w-8 h-8 bg-gradient-to-br from-white to-gray-400 pixel-corners pixel-shadow flex items-center justify-center">
                    <i data-lucide="zap" class="w-4 h-4 text-black"></i>
                </div>
                <h1 class="text-xl font-bold text-white retro-glow font-pixel">LinkFlow</h1>
            </div>
            <p class="text-xs text-gray-500 mt-2 ml-11 font-mono">ADMIN PANEL</p>
        </div>
        
        <!-- Navigation -->
        <nav class="flex-1 p-4 space-y-2 overflow-y-auto scrollbar-thin">
            <button 
                @click="currentView = 'dashboard'"
                :class="currentView === 'dashboard' ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200"
            >
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                <span class="font-medium">–ü–∞–Ω–µ–ª—å</span>
            </button>
            
            <button 
                @click="currentView = 'create'"
                :class="currentView === 'create' ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200"
            >
                <i data-lucide="credit-card" class="w-5 h-5"></i>
                <span class="font-medium">–°–æ–∑–¥–∞—Ç—å</span>
                <span x-show="payments.length > 0" class="ml-auto px-2 py-0.5 bg-blue-500/20 text-blue-400 text-xs rounded font-mono" x-text="payments.length"></span>
            </button>
            
            <button 
                @click="currentView = 'beneficiaries'"
                :class="currentView === 'beneficiaries' ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200"
            >
                <i data-lucide="user-check" class="w-5 h-5"></i>
                <span class="font-medium">–†–µ–∫–≤–∏–∑–∏—Ç—ã</span>
            </button>
            
            <button 
                @click="currentView = 'settings'"
                :class="currentView === 'settings' ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200"
            >
                <i data-lucide="settings" class="w-5 h-5"></i>
                <span class="font-medium">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </button>
        </nav>
        
        <!-- Status -->
        <div class="p-4 border-t border-white/10">
            <div class="flex items-center gap-3 px-4 py-3 pixel-corners bg-white/5">
                <div class="relative">
                    <div class="w-3 h-3 pixel-corners" :class="apiStatus === 'ok' ? 'bg-green-500' : 'bg-red-500'"></div>
                    <div class="absolute inset-0 w-3 h-3 pixel-corners animate-ping" :class="apiStatus === 'ok' ? 'bg-green-500' : 'bg-red-500'" style="opacity: 0.5;"></div>
                </div>
                <div class="flex-1">
                    <div class="text-xs text-gray-400 font-mono">API</div>
                    <div class="text-sm font-medium font-mono" x-text="apiStatus === 'ok' ? '–í –°–ï–¢–ò' : '–ù–ï –í –°–ï–¢–ò'"></div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="ml-64 min-h-screen p-8">
        
        <!-- Dashboard View -->
        <div x-show="currentView === 'dashboard'" x-transition class="space-y-6">
            <div class="mb-8">
                <h2 class="text-3xl font-bold mb-2 font-pixel retro-glow">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
                <p class="text-gray-400 font-mono">[ –û–ë–ó–û–† –°–ò–°–¢–ï–ú–´ ]</p>
            </div>
            
            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="pixel-border pixel-corners p-6 hover-lift scanlines">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-blue-500/20 pixel-corners flex items-center justify-center">
                            <i data-lucide="wallet" class="w-6 h-6 text-blue-400"></i>
                        </div>
                        <div class="text-xs text-gray-400 font-mono">–°–ï–ì–û–î–ù–Ø</div>
                    </div>
                    <div class="text-3xl font-bold mb-2 font-pixel retro-glow" x-text="(summary.today && summary.today.total) || 0"></div>
                    <div class="text-sm text-gray-400 font-mono">–ø–ª–∞—Ç–µ–∂–µ–π</div>
                </div>
                
                <div class="pixel-border pixel-corners p-6 hover-lift scanlines">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-green-500/20 pixel-corners flex items-center justify-center">
                            <i data-lucide="trending-up" class="w-6 h-6 text-green-400"></i>
                        </div>
                        <div class="text-xs text-gray-400 font-mono">–£–°–ü–ï–•</div>
                    </div>
                    <div class="text-3xl font-bold mb-2 font-pixel retro-glow" x-text="summary.today ? Math.round((summary.today.success / summary.today.total * 100) || 0) + '%' : '0%'"></div>
                    <div class="text-sm text-gray-400 font-mono">—É—Å–ø–µ—à–Ω—ã—Ö</div>
                </div>
                
                <div class="pixel-border pixel-corners p-6 hover-lift scanlines">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-purple-500/20 pixel-corners flex items-center justify-center">
                            <i data-lucide="banknote" class="w-6 h-6 text-purple-400"></i>
                        </div>
                        <div class="text-xs text-gray-400 font-mono">–°–£–ú–ú–ê</div>
                    </div>
                    <div class="text-3xl font-bold mb-2 font-pixel retro-glow" x-text="(summary.today && summary.today.amount) ? summary.today.amount.toLocaleString('ru-RU') + '‚ÇΩ' : '0‚ÇΩ'"></div>
                    <div class="text-sm text-gray-400 font-mono">—Å–µ–≥–æ–¥–Ω—è</div>
                </div>
                
                <div class="pixel-border pixel-corners p-6 hover-lift scanlines">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-orange-500/20 pixel-corners flex items-center justify-center">
                            <i data-lucide="clock" class="w-6 h-6 text-orange-400"></i>
                        </div>
                        <div class="text-xs text-gray-400 font-mono">–í–°–ï–ì–û</div>
                    </div>
                    <div class="text-3xl font-bold mb-2 font-pixel retro-glow" x-text="(summary.all_time && summary.all_time.total) || 0"></div>
                    <div class="text-sm text-gray-400 font-mono">–ø–ª–∞—Ç–µ–∂–µ–π</div>
                </div>
            </div>
            
            <!-- Period Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="pixel-border pixel-corners p-6 scanlines">
                    <h3 class="text-lg font-bold mb-4 font-pixel retro-glow">–ù–µ–¥–µ–ª—è</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–ü–ª–∞—Ç–µ–∂–µ–π:</span>
                            <span class="font-bold font-mono" x-text="(summary.week && summary.week.total) || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–£—Å–ø–µ—à–Ω—ã—Ö:</span>
                            <span class="font-bold text-green-400 font-mono" x-text="(summary.week && summary.week.success) || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–°—É–º–º–∞:</span>
                            <span class="font-bold font-mono" x-text="((summary.week && summary.week.amount) || 0).toLocaleString('ru-RU') + '‚ÇΩ'"></span>
                        </div>
                    </div>
                </div>
                
                <div class="pixel-border pixel-corners p-6 scanlines">
                    <h3 class="text-lg font-bold mb-4 font-pixel retro-glow">–ú–µ—Å—è—Ü</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–ü–ª–∞—Ç–µ–∂–µ–π:</span>
                            <span class="font-bold font-mono" x-text="(summary.month && summary.month.total) || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–£—Å–ø–µ—à–Ω—ã—Ö:</span>
                            <span class="font-bold text-green-400 font-mono" x-text="(summary.month && summary.month.success) || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–°—É–º–º–∞:</span>
                            <span class="font-bold font-mono" x-text="((summary.month && summary.month.amount) || 0).toLocaleString('ru-RU') + '‚ÇΩ'"></span>
                        </div>
                    </div>
                </div>
                
                <div class="pixel-border pixel-corners p-6 scanlines">
                    <h3 class="text-lg font-bold mb-4 font-pixel retro-glow">–í—Å—ë –≤—Ä–µ–º—è</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–ü–ª–∞—Ç–µ–∂–µ–π:</span>
                            <span class="font-bold font-mono" x-text="(summary.all_time && summary.all_time.total) || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–£—Å–ø–µ—à–Ω—ã—Ö:</span>
                            <span class="font-bold text-green-400 font-mono" x-text="(summary.all_time && summary.all_time.success) || 0"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400 font-mono">–°—É–º–º–∞:</span>
                            <span class="font-bold font-mono" x-text="((summary.all_time && summary.all_time.amount) || 0).toLocaleString('ru-RU') + '‚ÇΩ'"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Recent Payments -->
            <div class="pixel-border pixel-corners p-6 scanlines">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-bold font-pixel retro-glow">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∏</h3>
                    <button @click="currentView = 'payments'" class="text-sm text-blue-400 hover:text-blue-300 font-mono">–í—Å–µ ‚Üí</button>
                </div>
                <div class="space-y-3">
                    <template x-for="(payment, index) in payments.slice(0, 5)" :key="index">
                        <div class="flex items-center justify-between p-4 bg-white/5 pixel-corners hover:bg-white/10 transition-colors">
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 pixel-corners flex items-center justify-center" :class="payment.success ? 'bg-green-500/20' : 'bg-red-500/20'">
                                    <i :data-lucide="payment.success ? 'check-circle' : 'x-circle'" class="w-5 h-5" :class="payment.success ? 'text-green-400' : 'text-red-400'"></i>
                                </div>
                                <div>
                                    <div class="font-medium font-mono" x-text="payment.amount + ' ‚ÇΩ'"></div>
                                    <div class="text-sm text-gray-400 font-mono" x-text="payment.order_id"></div>
                                </div>
                            </div>
                            <div class="text-sm text-gray-400 font-mono" x-text="formatDate(payment.timestamp)"></div>
                        </div>
                    </template>
                    
                    <div x-show="payments.length === 0" class="text-center py-8 text-gray-400 font-mono">
                        [ –ù–ï–¢ –î–ê–ù–ù–´–• ]
                    </div>
                </div>
            </div>
        </div>


        <!-- Create Payment View -->
        <div x-show="currentView === 'create'" x-transition class="space-y-6">
            <div class="mb-8">
                <h2 class="text-3xl font-bold mb-2 font-pixel retro-glow">–°–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂</h2>
                <p class="text-gray-400 font-mono">[ –ù–û–í–´–ô –ü–õ–ê–¢–Å–ñ ]</p>
            </div>
            
            <div class="max-w-2xl">
                <div class="pixel-border pixel-corners p-8 scanlines">
                    <form @submit.prevent="createPayment" class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium mb-2 font-mono">–°–£–ú–ú–ê (–†–£–ë)</label>
                            <input 
                                type="number" 
                                x-model="form.amount"
                                min="100"
                                max="120000"
                                required
                                class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                                placeholder="1000"
                            >
                            <p class="mt-2 text-xs text-gray-400 font-mono">ID –∑–∞–∫–∞–∑–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</p>
                        </div>
                        </div>

                        <!-- Requisite Source Selection -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2 font-mono">–ò–°–¢–û–ß–ù–ò–ö –†–ï–ö–í–ò–ó–ò–¢–û–í</label>
                            <select
                                x-model="form.requisiteSource"
                                @change="changeRequisiteSource()"
                                class="w-full px-4 py-3 bg-black/50 text-white border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono cursor-pointer"
                                style="color-scheme: dark;"
                            >
                                <option value="auto" class="bg-black text-white">üîÑ –ê–≤—Ç–æ (H2H ‚Üí PayzTeam)</option>
                                <option value="h2h" class="bg-black text-white">üè¶ Liberty (—Ç–æ–ª—å–∫–æ H2H API)</option>
                                <option value="payzteam" class="bg-black text-white">üí≥ PayzTeam (—Ç–æ–ª—å–∫–æ PayzTeam API)</option>
                            </select>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400 font-mono" x-show="form.requisiteSource === 'auto'">
                                    –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç H2H API, –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å - PayzTeam API
                                </p>
                                <p class="text-xs text-gray-400 font-mono" x-show="form.requisiteSource === 'h2h'">
                                    –¢–æ–ª—å–∫–æ Liberty H2H API (api.liberty.top)
                                </p>
                                <p class="text-xs text-gray-400 font-mono" x-show="form.requisiteSource === 'payzteam'">
                                    –¢–æ–ª—å–∫–æ PayzTeam API (payzteam.com)
                                </p>
                            </div>
                        </div>

                        <!-- Advanced Options Toggle -->
                        <div class="border-t border-white/10 pt-4">
                            <button 
                                type="button"
                                @click="showAdvanced = !showAdvanced"
                                class="w-full px-4 py-2 bg-white/5 hover:bg-white/10 pixel-corners transition-colors font-mono flex items-center justify-between"
                            >
                                <span>–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –û–ü–¶–ò–ò</span>
                                <i :data-lucide="showAdvanced ? 'chevron-up' : 'chevron-down'" class="w-4 h-4"></i>
                            </button>
                        </div>
                        
                        <!-- Advanced Options Content -->
                        <div x-show="showAdvanced" x-transition class="space-y-4 p-4 bg-white/5 pixel-corners">
                            <!-- Custom Beneficiary Data -->
                            <label class="flex items-center gap-3 cursor-pointer">
                                <input type="checkbox" x-model="form.useCustomBeneficiary" class="w-5 h-5">
                                <span class="font-mono">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ–ª—É—á–∞—Ç–µ–ª—è</span>
                            </label>
                            
                            <div x-show="form.useCustomBeneficiary" x-transition class="space-y-3 pl-8">
                                <div>
                                    <label class="block text-xs font-medium mb-1 font-mono">–ù–û–ú–ï–† –ö–ê–†–¢–´</label>
                                    <input 
                                        type="text" 
                                        x-model="form.customCard"
                                        placeholder="9860606753188378"
                                        class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                    >
                                </div>
                                <div>
                                    <label class="block text-xs font-medium mb-1 font-mono">–í–õ–ê–î–ï–õ–ï–¶ –ö–ê–†–¢–´</label>
                                    <input 
                                        type="text" 
                                        x-model="form.customOwner"
                                        placeholder="ASIYA ESEMURATOVA"
                                        class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                    >
                                </div>
                            </div>
                            
                            <!-- Custom Sender Data -->
                            <label class="flex items-center gap-3 cursor-pointer">
                                <input type="checkbox" x-model="form.useCustomSender" class="w-5 h-5">
                                <span class="font-mono">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–∏ –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</span>
                            </label>
                            
                            <div x-show="form.useCustomSender" x-transition class="space-y-3 pl-8">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs font-medium mb-1 font-mono">–ò–ú–Ø</label>
                                        <input 
                                            type="text" 
                                            x-model="form.senderFirstName"
                                            class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium mb-1 font-mono">–§–ê–ú–ò–õ–ò–Ø</label>
                                        <input 
                                            type="text" 
                                            x-model="form.senderLastName"
                                            class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                        >
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium mb-1 font-mono">–û–¢–ß–ï–°–¢–í–û</label>
                                    <input 
                                        type="text" 
                                        x-model="form.senderMiddleName"
                                        class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                    >
                                </div>
                                <div>
                                    <label class="block text-xs font-medium mb-1 font-mono">–î–ê–¢–ê –†–û–ñ–î–ï–ù–ò–Ø (–î–î.–ú–ú.–ì–ì–ì–ì)</label>
                                    <input 
                                        type="text" 
                                        x-model="form.senderBirthDate"
                                        placeholder="14.07.2017"
                                        class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                    >
                                </div>
                                <div>
                                    <label class="block text-xs font-medium mb-1 font-mono">–¢–ï–õ–ï–§–û–ù</label>
                                    <input 
                                        type="text" 
                                        x-model="form.senderPhone"
                                        placeholder="+79001234567"
                                        class="w-full px-3 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-sm"
                                    >
                                </div>
                            </div>
                        </div>
                        
                        <button 
                            type="submit"
                            :disabled="loading"
                            class="w-full px-6 py-4 bg-white text-black pixel-corners font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-mono pixel-shadow"
                        >
                            <template x-if="!loading">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="send" class="w-5 h-5"></i>
                                    <span>–°–û–ó–î–ê–¢–¨</span>
                                </div>
                            </template>
                            <template x-if="loading">
                                <div class="flex items-center gap-2">
                                    <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    <span>–ó–ê–ì–†–£–ó–ö–ê...</span>
                                </div>
                            </template>
                        </button>
                    </form>
                    
                    <div x-show="result" x-transition class="mt-6 p-6 pixel-corners" :class="result?.success ? 'bg-green-500/10 border border-green-500/20' : 'bg-red-500/10 border border-red-500/20'">
                        <div class="flex items-start gap-3">
                            <div class="w-10 h-10 pixel-corners flex items-center justify-center flex-shrink-0" :class="result?.success ? 'bg-green-500/20' : 'bg-red-500/20'">
                                <i :data-lucide="result?.success ? 'check-circle' : 'alert-circle'" class="w-5 h-5" :class="result?.success ? 'text-green-400' : 'text-red-400'"></i>
                            </div>
                            <div class="flex-1">
                                <div class="font-medium mb-2 font-mono" x-text="result?.success ? '–£–°–ü–ï–•!' : '–û–®–ò–ë–ö–ê!'"></div>
                                
                                <template x-if="result?.success && result?.qr_link">
                                    <div>
                                        <div class="p-3 bg-black/50 pixel-corners font-mono text-sm break-all mb-3" x-text="result.qr_link"></div>
                                        <button 
                                            @click="copyToClipboard(result.qr_link)"
                                            class="w-full px-4 py-2 bg-white/10 hover:bg-white/20 pixel-corners text-sm transition-colors flex items-center justify-center gap-2 font-mono"
                                        >
                                            <i data-lucide="copy" class="w-4 h-4"></i>
                                            <span>–ö–û–ü–ò–†–û–í–ê–¢–¨</span>
                                        </button>
                                    </div>
                                </template>
                                
                                <template x-if="!result?.success">
                                    <div class="text-sm text-gray-400 font-mono" x-text="result?.error"></div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Payment Logs (Real-time) -->
            <div class="mt-8" x-show="loading || result">
                <div class="pixel-border pixel-corners p-6 scanlines">
                    <div class="flex items-center gap-3 mb-4">
                        <i data-lucide="terminal" class="w-5 h-5 text-blue-400"></i>
                        <h3 class="text-xl font-bold font-pixel retro-glow">–õ–û–ì–ò –°–û–ó–î–ê–ù–ò–Ø</h3>
                    </div>
                    <div class="bg-black/50 pixel-corners p-4 max-h-[500px] overflow-y-auto scrollbar-thin font-mono text-sm">
                        <div x-show="paymentLogs.length === 0" class="text-gray-500 text-center py-8">
                            –û–∂–∏–¥–∞–Ω–∏–µ –ª–æ–≥–æ–≤...
                        </div>
                        <template x-for="(log, index) in paymentLogs" :key="index">
                            <div class="py-1" :class="{
                                'text-green-400': log.level === 'SUCCESS',
                                'text-blue-400': log.level === 'INFO',
                                'text-yellow-400': log.level === 'WARNING',
                                'text-red-400': log.level === 'ERROR',
                                'text-gray-400': log.level === 'DEBUG'
                            }">
                                <span class="text-gray-600" x-text="'[' + log.time + ']'"></span>
                                <span x-text="log.icon + ' ' + log.message"></span>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- Payments List -->
            <div class="mt-8">
                <div class="mb-6 flex items-center justify-between">
                    <h3 class="text-2xl font-bold font-pixel retro-glow">–°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π</h3>
                    <div class="flex gap-2">
                        <button @click="exportData('json')" class="px-3 py-2 bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 pixel-corners transition-colors font-mono flex items-center gap-2 text-sm">
                            <i data-lucide="download" class="w-4 h-4"></i>
                            JSON
                        </button>
                        <button @click="exportData('csv')" class="px-3 py-2 bg-green-500/20 text-green-400 hover:bg-green-500/30 pixel-corners transition-colors font-mono flex items-center gap-2 text-sm">
                            <i data-lucide="file-text" class="w-4 h-4"></i>
                            CSV
                        </button>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="flex flex-wrap gap-4 mb-6">
                    <input 
                        type="text" 
                        x-model="searchQuery"
                        @input="searchPayments"
                        placeholder="–ü–æ–∏—Å–∫ –ø–æ ID..."
                        class="flex-1 min-w-[200px] px-4 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                    >
                    <select x-model="filterStatus" @change="loadPayments" class="px-4 py-2 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono">
                        <option value="all">–í—Å–µ</option>
                        <option value="success">–£—Å–ø–µ—à–Ω—ã–µ</option>
                        <option value="failed">–ù–µ—É–¥–∞—á–Ω—ã–µ</option>
                    </select>
                </div>
                
                <!-- Payments Table -->
                <div class="pixel-border pixel-corners p-6 scanlines">
                    <div class="space-y-3 max-h-[600px] overflow-y-auto scrollbar-thin">
                        <template x-for="(payment, index) in payments" :key="index">
                            <div class="p-6 bg-white/5 pixel-corners hover:bg-white/10 transition-all duration-200">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex items-center gap-4">
                                        <div class="w-12 h-12 pixel-corners flex items-center justify-center" :class="payment.success ? 'bg-green-500/20' : 'bg-red-500/20'">
                                            <i :data-lucide="payment.success ? 'check-circle' : 'x-circle'" class="w-6 h-6" :class="payment.success ? 'text-green-400' : 'text-red-400'"></i>
                                        </div>
                                        <div>
                                            <div class="text-2xl font-bold font-pixel retro-glow" x-text="payment.amount + ' ‚ÇΩ'"></div>
                                            <div class="text-sm text-gray-400 font-mono" x-text="'ID: ' + payment.order_id"></div>
                                            <div class="text-xs text-gray-500 font-mono" x-text="'Payment ID: ' + payment.id"></div>
                                        </div>
                                    </div>
                                    <div class="px-3 py-1 pixel-corners text-xs font-medium flex items-center gap-1 font-mono" :class="payment.success ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'">
                                        <i :data-lucide="payment.success ? 'check' : 'x'" class="w-3 h-3"></i>
                                        <span x-text="payment.success ? '–û–ö' : '–û–®–ò–ë–ö–ê'"></span>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-4 text-sm text-gray-400 mb-3 font-mono">
                                    <div class="flex items-center gap-2">
                                        <i data-lucide="clock" class="w-4 h-4"></i>
                                        <span x-text="formatDate(payment.timestamp)"></span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <i data-lucide="zap" class="w-4 h-4"></i>
                                        <span x-text="payment.payment_time + 's'"></span>
                                    </div>
                                </div>
                                
                                <template x-if="payment.qr_link">
                                    <button 
                                        @click="copyToClipboard(payment.qr_link)"
                                        class="px-4 py-2 bg-white/10 hover:bg-white/20 pixel-corners text-sm transition-colors flex items-center gap-2 font-mono"
                                    >
                                        <i data-lucide="copy" class="w-4 h-4"></i>
                                        <span>–ö–û–ü–ò–†–û–í–ê–¢–¨ –°–°–´–õ–ö–£</span>
                                    </button>
                                </template>
                            </div>
                        </template>
                        
                        <div x-show="payments.length === 0" class="text-center py-16">
                            <div class="w-20 h-20 mx-auto mb-4 bg-white/5 pixel-corners flex items-center justify-center">
                                <i data-lucide="inbox" class="w-10 h-10 text-gray-600"></i>
                            </div>
                            <div class="text-xl text-gray-400 font-mono">[ –ù–ï–¢ –ü–õ–ê–¢–ï–ñ–ï–ô ]</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        <!-- Settings View -->
        <div x-show="currentView === 'settings'" x-transition class="max-w-3xl space-y-6">
            <div class="mb-8">
                <h2 class="text-3xl font-bold mb-2 font-pixel retro-glow">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <p class="text-gray-400 font-mono">[ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ ]</p>
            </div>
            
            <div class="pixel-border pixel-corners p-8 scanlines">
                <form @submit.prevent="saveSettings" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2 font-mono">API URL</label>
                        <input 
                            type="text" 
                            x-model="settings.api_url"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                        >
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2 font-mono">API TOKEN</label>
                        <input 
                            type="password" 
                            x-model="settings.api_token"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                        >
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 font-mono">–ú–ò–ù. –°–£–ú–ú–ê (‚ÇΩ)</label>
                            <input 
                                type="number" 
                                x-model="settings.min_amount"
                                class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 font-mono">–ú–ê–ö–°. –°–£–ú–ú–ê (‚ÇΩ)</label>
                            <input 
                                type="number" 
                                x-model="settings.max_amount"
                                class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                            >
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2 font-mono">–ü–†–û–ö–°–ò (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                        <input 
                            type="text" 
                            x-model="settings.proxy"
                            placeholder="http://user:pass@host:port"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                        >
                        <p class="mt-2 text-xs text-gray-400 font-mono">–§–æ—Ä–º–∞—Ç: http://user:pass@host:port –∏–ª–∏ socks5://host:port</p>
                    </div>
                    
                    <div class="space-y-3">
                        <label class="flex items-center gap-3 cursor-pointer">
                            <input type="checkbox" x-model="settings.auto_retry" class="w-5 h-5">
                            <span class="font-mono">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–≤—Ç–æ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–µ</span>
                        </label>
                        
                        <label class="flex items-center gap-3 cursor-pointer">
                            <input type="checkbox" x-model="settings.notifications_enabled" class="w-5 h-5">
                            <span class="font-mono">–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        </label>
                    </div>
                    
                    <button 
                        type="submit"
                        class="w-full px-6 py-4 bg-white text-black pixel-corners font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 font-mono pixel-shadow"
                    >
                        <i data-lucide="save" class="w-5 h-5"></i>
                        <span>–°–û–•–†–ê–ù–ò–¢–¨</span>
                    </button>
                </form>
            </div>
            
            <!-- Logs Section -->
            <div class="mt-8">
                <div class="mb-6 flex items-center justify-between">
                    <h3 class="text-2xl font-bold font-pixel retro-glow">–õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    <button @click="loadLogs" class="px-4 py-2 bg-white/10 hover:bg-white/20 pixel-corners transition-colors font-mono flex items-center gap-2">
                        <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                        –û–ë–ù–û–í–ò–¢–¨
                    </button>
                </div>
                
                <div class="pixel-border pixel-corners p-6 scanlines">
                    <div class="space-y-2 max-h-[600px] overflow-y-auto scrollbar-thin font-mono text-sm">
                        <template x-for="(log, index) in logs" :key="index">
                            <div class="p-3 bg-white/5 pixel-corners hover:bg-white/10 transition-colors flex items-start gap-3">
                                <div class="px-2 py-1 pixel-corners text-xs font-bold" :class="{
                                    'bg-green-500/20 text-green-400': log.level === 'success',
                                    'bg-red-500/20 text-red-400': log.level === 'error',
                                    'bg-blue-500/20 text-blue-400': log.level === 'info',
                                    'bg-yellow-500/20 text-yellow-400': log.level === 'warning',
                                    'bg-gray-500/20 text-gray-400': log.level === 'settings'
                                }" x-text="log.level.toUpperCase()"></div>
                                <div class="flex-1">
                                    <div class="text-gray-300" x-text="log.message"></div>
                                    <div class="text-xs text-gray-500 mt-1" x-text="formatDate(log.timestamp)"></div>
                                </div>
                            </div>
                        </template>
                        
                        <div x-show="logs.length === 0" class="text-center py-16 text-gray-400">
                            [ –ù–ï–¢ –õ–û–ì–û–í ]
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Beneficiaries View -->
        <div x-show="currentView === 'beneficiaries'" x-transition class="space-y-6">
            <div class="mb-8">
                <h2 class="text-3xl font-bold mb-2 font-pixel retro-glow">–†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π</h2>
                <p class="text-gray-400 font-mono">[ –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ö–í–ò–ó–ò–¢–ê–ú–ò ]</p>
            </div>
            
            <!-- Add New Beneficiary Form -->
            <div class="pixel-border pixel-corners p-8 scanlines">
                <h3 class="text-xl font-bold mb-6 font-mono">–î–û–ë–ê–í–ò–¢–¨ –†–ï–ö–í–ò–ó–ò–¢</h3>
                
                <form @submit.prevent="addBeneficiary" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 font-mono">–ù–û–ú–ï–† –ö–ê–†–¢–´</label>
                            <input 
                                type="text" 
                                x-model="newBeneficiary.card_number"
                                placeholder="9860606753188378"
                                required
                                maxlength="16"
                                class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 font-mono">–í–õ–ê–î–ï–õ–ï–¶ –ö–ê–†–¢–´</label>
                            <input 
                                type="text" 
                                x-model="newBeneficiary.card_owner"
                                placeholder="ASIYA ESEMURATOVA"
                                required
                                class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                            >
                        </div>
                    </div>
                    
                    <button 
                        type="submit"
                        :disabled="loadingBeneficiary"
                        class="w-full px-6 py-4 bg-white text-black pixel-corners font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-mono pixel-shadow"
                    >
                        <template x-if="!loadingBeneficiary">
                            <div class="flex items-center gap-2">
                                <i data-lucide="plus-circle" class="w-5 h-5"></i>
                                <span>–î–û–ë–ê–í–ò–¢–¨ –ò –ü–†–û–í–ï–†–ò–¢–¨</span>
                            </div>
                        </template>
                        <template x-if="loadingBeneficiary">
                            <div class="flex items-center gap-2">
                                <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                <span>–ü–†–û–í–ï–†–ö–ê...</span>
                            </div>
                        </template>
                    </button>
                </form>
                
                <div class="mt-4 p-4 bg-blue-500/10 border border-blue-500/20 pixel-corners">
                    <div class="flex items-start gap-3">
                        <div class="w-8 h-8 bg-blue-500/20 pixel-corners flex items-center justify-center flex-shrink-0">
                            <i data-lucide="info" class="w-4 h-4 text-blue-400"></i>
                        </div>
                        <div class="text-sm text-gray-300 font-mono">
                            –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Ω–∞ 110‚ÇΩ. 
                            –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 20-30 —Å–µ–∫—É–Ω–¥. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- API Tester -->
            <div class="pixel-border pixel-corners p-6 scanlines mb-6">
                <h3 class="text-xl font-bold mb-6 font-mono">–¢–ï–°–¢–ï–† API –†–ï–ö–í–ò–ó–ò–¢–û–í</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium mb-2 font-mono">–°–£–ú–ú–ê</label>
                        <input 
                            type="number" 
                            x-model="apiTester.amount"
                            placeholder="300"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 font-mono">API</label>
                        <select 
                            x-model="apiTester.source"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 pixel-corners focus:outline-none focus:border-white/30 transition-colors font-mono text-white"
                            style="color: white; background-color: rgba(255,255,255,0.05);"
                        >
                            <option value="h2h" style="color: black; background-color: white;">H2H API</option>
                            <option value="payzteam" style="color: black; background-color: white;">PayzTeam API</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button 
                            @click="testRequisiteAPI()"
                            :disabled="apiTester.loading"
                            class="w-full px-6 py-3 bg-white text-black pixel-corners font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-mono"
                        >
                            <i data-lucide="play" class="w-5 h-5"></i>
                            <span x-show="!apiTester.loading">–¢–ï–°–¢</span>
                            <span x-show="apiTester.loading">...</span>
                        </button>
                    </div>
                </div>
                
                <!-- API Response -->
                <div x-show="apiTester.response" class="mt-4">
                    <div class="flex items-center justify-between mb-2">
                        <label class="block text-sm font-medium font-mono">–û–¢–í–ï–¢ API</label>
                        <button 
                            @click="copyToClipboard(JSON.stringify(apiTester.response, null, 2))"
                            class="px-3 py-1 bg-white/5 hover:bg-white/10 pixel-corners text-xs transition-colors font-mono flex items-center gap-2"
                        >
                            <i data-lucide="copy" class="w-3 h-3"></i>
                            –ö–û–ü–ò–†–û–í–ê–¢–¨
                        </button>
                    </div>
                    <pre class="p-4 bg-black/50 border border-white/10 pixel-corners overflow-x-auto text-xs font-mono text-green-400" x-text="JSON.stringify(apiTester.response, null, 2)"></pre>
                </div>
            </div>
            
            <!-- Beneficiaries List -->
            <div class="pixel-border pixel-corners p-6 scanlines">
                <h3 class="text-xl font-bold mb-6 font-mono">–°–ü–ò–°–û–ö –†–ï–ö–í–ò–ó–ò–¢–û–í</h3>
                
                <div class="space-y-3">
                    <template x-for="(beneficiary, index) in beneficiaries" :key="beneficiary.id">
                        <div class="p-6 bg-white/5 pixel-corners hover:bg-white/10 transition-all duration-200">
                            <div class="flex items-start justify-between">
                                <div class="flex items-start gap-4 flex-1">
                                    <!-- Verification Status Icon -->
                                    <div class="w-12 h-12 pixel-corners flex items-center justify-center flex-shrink-0" :class="beneficiary.is_verified ? 'bg-green-500/20' : 'bg-red-500/20'">
                                        <i :data-lucide="beneficiary.is_verified ? 'check-circle' : 'x-circle'" class="w-6 h-6" :class="beneficiary.is_verified ? 'text-green-400' : 'text-red-400'"></i>
                                    </div>
                                    
                                    <!-- Beneficiary Info -->
                                    <div class="flex-1">
                                        <div class="flex items-center gap-3 mb-2">
                                            <div class="text-lg font-bold font-mono" x-text="beneficiary.card_owner"></div>
                                            <div class="px-2 py-1 pixel-corners text-xs font-medium" :class="beneficiary.is_active ? 'bg-green-500/20 text-green-400' : 'bg-gray-500/20 text-gray-400'">
                                                <span x-text="beneficiary.is_active ? '–ê–ö–¢–ò–í–ï–ù' : '–û–¢–ö–õ–Æ–ß–ï–ù'"></span>
                                            </div>
                                        </div>
                                        <div class="text-sm text-gray-400 font-mono mb-1" x-text="'–ö–∞—Ä—Ç–∞: ' + beneficiary.card_number"></div>
                                        <div class="text-xs text-gray-500 font-mono" x-text="'–î–æ–±–∞–≤–ª–µ–Ω: ' + formatDate(beneficiary.created_at)"></div>
                                        <template x-if="beneficiary.last_test_date">
                                            <div class="text-xs text-gray-500 font-mono" x-text="'–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ' + formatDate(beneficiary.last_test_date)"></div>
                                        </template>
                                    </div>
                                </div>
                                
                                <!-- Actions -->
                                <div class="flex items-center gap-2">
                                    <button 
                                        @click="retestBeneficiary(beneficiary.id, beneficiary.card_number, beneficiary.card_owner)"
                                        :disabled="retestingId === beneficiary.id"
                                        class="px-3 py-2 bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 pixel-corners text-sm transition-colors font-mono disabled:opacity-50 disabled:cursor-not-allowed"
                                    >
                                        <span x-show="retestingId !== beneficiary.id">–ü–†–û–í–ï–†–ò–¢–¨</span>
                                        <span x-show="retestingId === beneficiary.id">...</span>
                                    </button>
                                    <button 
                                        @click="toggleBeneficiary(beneficiary.id, !beneficiary.is_active)"
                                        class="px-3 py-2 pixel-corners text-sm transition-colors font-mono"
                                        :class="beneficiary.is_active ? 'bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30' : 'bg-green-500/20 text-green-400 hover:bg-green-500/30'"
                                    >
                                        <span x-text="beneficiary.is_active ? '–û–¢–ö–õ–Æ–ß–ò–¢–¨' : '–í–ö–õ–Æ–ß–ò–¢–¨'"></span>
                                    </button>
                                    <button 
                                        @click="deleteBeneficiary(beneficiary.id)"
                                        class="px-3 py-2 bg-red-500/20 text-red-400 hover:bg-red-500/30 pixel-corners text-sm transition-colors font-mono"
                                    >
                                        –£–î–ê–õ–ò–¢–¨
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                    
                    <div x-show="beneficiaries.length === 0" class="text-center py-16">
                        <div class="w-20 h-20 mx-auto mb-4 bg-white/5 pixel-corners flex items-center justify-center">
                            <i data-lucide="credit-card" class="w-10 h-10 text-gray-600"></i>
                        </div>
                        <div class="text-xl text-gray-400 font-mono">[ –ù–ï–¢ –†–ï–ö–í–ò–ó–ò–¢–û–í ]</div>
                        <div class="text-sm text-gray-500 font-mono mt-2">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Ä–µ–∫–≤–∏–∑–∏—Ç –≤—ã—à–µ</div>
                    </div>
                </div>
            </div>
        </div>
        
    </main>

    <!-- Toast Notifications -->
    <div class="fixed bottom-6 right-6 z-50 space-y-3">
        <template x-for="(toast, index) in toasts" :key="index">
            <div 
                x-show="toast.show"
                x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 transform translate-x-full"
                x-transition:enter-end="opacity-100 transform translate-x-0"
                x-transition:leave="transition ease-in duration-200"
                x-transition:leave-start="opacity-100 transform translate-x-0"
                x-transition:leave-end="opacity-0 transform translate-x-full"
                class="glass rounded-xl p-4 min-w-[300px] border border-white/20"
            >
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" :class="toast.type === 'success' ? 'bg-green-500/20' : 'bg-red-500/20'">
                        <i :data-lucide="toast.type === 'success' ? 'check-circle' : 'alert-circle'" class="w-5 h-5" :class="toast.type === 'success' ? 'text-green-400' : 'text-red-400'"></i>
                    </div>
                    <div>
                        <div class="font-medium" x-text="toast.title"></div>
                        <div class="text-sm text-gray-400" x-text="toast.message"></div>
                    </div>
                </div>
            </div>
        </template>
    </div>
    
    <script>
        function adminApp() {
            return {
                currentView: 'dashboard',
                apiStatus: 'checking',
                loading: false,
                result: null,
                showAdvanced: false,
                form: {
                    amount: '',
                    paymentSystem: 'multitransfer',
                    requisiteSource: 'auto',
                    useCustomBeneficiary: false,
                    customCard: '',
                    customOwner: '',
                    useCustomSender: false,
                    senderFirstName: '',
                    senderLastName: '',
                    senderMiddleName: '',
                    senderBirthDate: '',
                    senderPhone: ''
                },
                payments: [],
                logs: [],
                summary: {},
                analytics: {},
                analyticsPeriod: 30,
                settings: {},
                beneficiaries: [],
                newBeneficiary: {
                    card_number: '',
                    card_owner: ''
                },
                loadingBeneficiary: false,
                retestingId: null,
                apiTester: {
                    amount: 300,
                    source: 'h2h',
                    loading: false,
                    response: null
                },
                toasts: [],
                searchQuery: '',
                filterStatus: 'all',
                paymentsChart: null,
                successChart: null,
                paymentLogs: [],
                logPollingInterval: null,
                
                init() {
                    this.checkApiStatus();
                    this.loadSummary();
                    this.loadPayments();
                    this.loadRequisiteSource();
                    this.loadSettings();
                    this.loadLogs();
                    this.loadAnalytics(30);
                    this.loadBeneficiaries();
                    
                    setInterval(() => this.checkApiStatus(), 10000);
                    setInterval(() => this.loadLogs(), 5000);
                    
                    // Watch for view changes to update icons
                    this.$watch('currentView', () => {
                        this.$nextTick(() => {
                            if (window.lucide) lucide.createIcons();
                            if (this.currentView === 'analytics') {
                                setTimeout(() => this.renderCharts(), 100);
                            }
                        });
                    });
                },
                
                async checkApiStatus() {
                    try {
                        const response = await fetch('/api/health');
                        const data = await response.json();
                        this.apiStatus = data.status === 'ok' ? 'ok' : 'error';
                    } catch {
                        this.apiStatus = 'error';
                    }
                },
                
                async loadSummary() {
                    try {
                        const response = await fetch('/api/stats/summary');
                        const data = await response.json();
                        if (data.success) {
                            this.summary = data;
                        }
                    } catch (error) {
                        console.error('Failed to load summary:', error);
                    }
                },
                
                async loadPayments() {
                    try {
                        const response = await fetch(`/api/payments?status=${this.filterStatus}&per_page=50`);
                        const data = await response.json();
                        if (data.success) {
                            this.payments = data.payments;
                        }
                    } catch (error) {
                        console.error('Failed to load payments:', error);
                    }
                },
                
                async loadLogs() {
                    try {
                        const response = await fetch('/api/logs?limit=50');
                        const data = await response.json();
                        if (data.success) {
                            this.logs = data.logs;
                        }
                    } catch (error) {
                        console.error('Failed to load logs:', error);
                    }
                },
                
                async loadSettings() {
                    try {
                        const response = await fetch('/api/settings');
                        const data = await response.json();
                        if (data.success) {
                            this.settings = data.settings;
                        }
                    } catch (error) {
                        console.error('Failed to load settings:', error);
                    }
                },
                
                async saveSettings() {
                    try {
                        const response = await fetch('/api/settings', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.settings)
                        });
                        const data = await response.json();
                        if (data.success) {
                            this.showToast('success', '–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
                        }
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏');
                    }
                },
                
                async loadAnalytics(days) {
                    this.analyticsPeriod = days;
                    try {
                        const response = await fetch(`/api/analytics?period=${days}`);
                        const data = await response.json();
                        if (data.success) {
                            this.analytics = data;
                            this.$nextTick(() => this.renderCharts());
                        }
                    } catch (error) {
                        console.error('Failed to load analytics:', error);
                    }
                },
                
                renderCharts() {
                    // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥—Ä–∞—Ñ–∏–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
                    const chartData = this.analytics.chart_data || [];
                    const labels = chartData.length > 0 ? chartData.map(d => d.date) : ['–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'];
                    const totals = chartData.length > 0 ? chartData.map(d => d.total) : [0];
                    const successes = chartData.length > 0 ? chartData.map(d => d.success) : [0];
                    const successRates = chartData.length > 0 ? chartData.map(d => d.success_rate) : [0];
                    
                    // –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç—ë–º–Ω–æ–π —Ç–µ–º—ã
                    const darkThemeOptions = {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { 
                                    color: '#fff',
                                    font: {
                                        family: 'JetBrains Mono, monospace',
                                        size: 12
                                    },
                                    padding: 15
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                titleColor: '#fff',
                                bodyColor: '#fff',
                                borderColor: 'rgba(255, 255, 255, 0.2)',
                                borderWidth: 1,
                                padding: 12,
                                titleFont: {
                                    family: 'JetBrains Mono, monospace',
                                    size: 13
                                },
                                bodyFont: {
                                    family: 'JetBrains Mono, monospace',
                                    size: 12
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: { 
                                    color: '#888',
                                    font: {
                                        family: 'JetBrains Mono, monospace',
                                        size: 11
                                    }
                                },
                                grid: { 
                                    color: 'rgba(255,255,255,0.05)',
                                    lineWidth: 1
                                },
                                border: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            },
                            x: {
                                ticks: { 
                                    color: '#888',
                                    font: {
                                        family: 'JetBrains Mono, monospace',
                                        size: 11
                                    },
                                    maxRotation: 45,
                                    minRotation: 45
                                },
                                grid: { 
                                    color: 'rgba(255,255,255,0.05)',
                                    lineWidth: 1
                                },
                                border: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            }
                        }
                    };
                    
                    // Payments Chart
                    const paymentsCtx = document.getElementById('paymentsChart');
                    if (paymentsCtx) {
                        if (this.paymentsChart) this.paymentsChart.destroy();
                        this.paymentsChart = new Chart(paymentsCtx, {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [{
                                    label: '–í—Å–µ–≥–æ',
                                    data: totals,
                                    borderColor: 'rgb(59, 130, 246)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                    borderWidth: 3,
                                    tension: 0.4,
                                    fill: true,
                                    pointRadius: 4,
                                    pointHoverRadius: 6,
                                    pointBackgroundColor: 'rgb(59, 130, 246)',
                                    pointBorderColor: '#000',
                                    pointBorderWidth: 2
                                }, {
                                    label: '–£—Å–ø–µ—à–Ω—ã—Ö',
                                    data: successes,
                                    borderColor: 'rgb(34, 197, 94)',
                                    backgroundColor: 'rgba(34, 197, 94, 0.2)',
                                    borderWidth: 3,
                                    tension: 0.4,
                                    fill: true,
                                    pointRadius: 4,
                                    pointHoverRadius: 6,
                                    pointBackgroundColor: 'rgb(34, 197, 94)',
                                    pointBorderColor: '#000',
                                    pointBorderWidth: 2
                                }]
                            },
                            options: darkThemeOptions
                        });
                    }
                    
                    // Success Rate Chart
                    const successCtx = document.getElementById('successChart');
                    if (successCtx) {
                        if (this.successChart) this.successChart.destroy();
                        this.successChart = new Chart(successCtx, {
                            type: 'bar',
                            data: {
                                labels: labels,
                                datasets: [{
                                    label: '–£—Å–ø–µ—à–Ω–æ—Å—Ç—å %',
                                    data: successRates,
                                    backgroundColor: 'rgba(34, 197, 94, 0.7)',
                                    borderColor: 'rgb(34, 197, 94)',
                                    borderWidth: 2,
                                    borderRadius: 0,
                                    hoverBackgroundColor: 'rgba(34, 197, 94, 0.9)',
                                    hoverBorderColor: 'rgb(34, 197, 94)',
                                    hoverBorderWidth: 3
                                }]
                            },
                            options: {
                                ...darkThemeOptions,
                                scales: {
                                    ...darkThemeOptions.scales,
                                    y: {
                                        ...darkThemeOptions.scales.y,
                                        max: 100
                                    }
                                }
                            }
                        });
                    }
                },
                
                async changeRequisiteSource() {
                    try {
                        const response = await fetch('/api/requisite-source', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': 'Bearer -3uVLlbWyy90eapOGkv70C2ZltaYTxq-HtDbq-DtlLo'
                            },
                            body: JSON.stringify({
                                source: this.form.requisiteSource
                            })
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            this.showToast('success', '–£—Å–ø–µ—Ö', `–ò—Å—Ç–æ—á–Ω–∏–∫ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${this.form.requisiteSource}`);
                        } else {
                            this.showToast('error', '–û—à–∏–±–∫–∞', data.error);
                        }
                    } catch (error) {
                        console.error('Error changing requisite source:', error);
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤');
                    }
                },
                
                async loadRequisiteSource() {
                    try {
                        const response = await fetch('/api/requisite-source');
                        const data = await response.json();
                        
                        if (data.success) {
                            this.form.requisiteSource = data.source;
                        }
                    } catch (error) {
                        console.error('Error loading requisite source:', error);
                    }
                },
                
                async createPayment() {
                    this.loading = true;
                    this.result = null;
                    this.paymentLogs = [];
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤
                    this.startLogPolling();
                    
                    try {
                        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º orderId
                        const orderId = `ORD-${Date.now()}-${Math.floor(Math.random() * 10000)}`;
                        
                        const payload = {
                            amount: parseInt(this.form.amount),
                            orderId: orderId,
                            payment_system: this.form.paymentSystem
                        };
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è multitransfer)
                        if (this.form.paymentSystem === 'multitransfer') {
                            if (this.form.useCustomBeneficiary && this.form.customCard && this.form.customOwner) {
                                payload.card_number = this.form.customCard;
                                payload.card_owner = this.form.customOwner;
                            }
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã
                            if (this.form.useCustomSender) {
                                payload.custom_sender = {
                                    first_name: this.form.senderFirstName,
                                    last_name: this.form.senderLastName,
                                    middle_name: this.form.senderMiddleName,
                                    birth_date: this.form.senderBirthDate,
                                    phone: this.form.senderPhone
                                };
                            }
                        }
                        
                        const response = await fetch('/api/create-payment', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        const data = await response.json();
                        this.result = data;
                        
                        this.showToast(
                            data.success ? 'success' : 'error',
                            data.success ? '–£—Å–ø–µ—Ö!' : '–û—à–∏–±–∫–∞',
                            data.success ? `–ü–ª–∞—Ç—ë–∂ –Ω–∞ ${this.form.amount}‚ÇΩ —Å–æ–∑–¥–∞–Ω` : data.error
                        );
                        
                        if (data.success) {
                            this.form.amount = '';
                            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è
                            this.form.useCustomBeneficiary = false;
                            this.form.customCard = '';
                            this.form.customOwner = '';
                            this.form.useCustomSender = false;
                            this.form.senderFirstName = '';
                            this.form.senderLastName = '';
                            this.form.senderMiddleName = '';
                            this.form.senderBirthDate = '';
                            this.form.senderPhone = '';
                            this.showAdvanced = false;
                            this.loadPayments();
                            this.loadSummary();
                        }
                    } catch (error) {
                        this.result = { success: false, error: error.message };
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
                    } finally {
                        this.loading = false;
                        this.stopLogPolling();
                        this.$nextTick(() => {
                            if (window.lucide) lucide.createIcons();
                        });
                    }
                },
                
                startLogPolling() {
                    // –ü–æ–ª—É—á–∞–µ–º –ª–æ–≥–∏ –∫–∞–∂–¥—ã–µ 500ms
                    this.logPollingInterval = setInterval(() => {
                        this.fetchPaymentLogs();
                    }, 500);
                    this.fetchPaymentLogs(); // –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å—Ä–∞–∑—É
                },
                
                stopLogPolling() {
                    if (this.logPollingInterval) {
                        clearInterval(this.logPollingInterval);
                        this.logPollingInterval = null;
                    }
                },
                
                async fetchPaymentLogs() {
                    try {
                        const response = await fetch('/api/payment-logs/current');
                        const data = await response.json();
                        if (data.success && data.logs) {
                            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ª–æ–≥–∏ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                            this.paymentLogs = data.logs.map(log => ({
                                time: new Date(log.timestamp).toLocaleTimeString('ru-RU'),
                                level: log.level.toUpperCase(),
                                message: log.message,
                                icon: this.getLogIcon(log.level)
                            }));
                        }
                    } catch (error) {
                        console.error('Failed to fetch payment logs:', error);
                    }
                },
                
                getLogIcon(level) {
                    const icons = {
                        'success': '‚úÖ',
                        'info': '‚ÑπÔ∏è',
                        'warning': '‚ö†Ô∏è',
                        'error': '‚ùå',
                        'debug': 'üîç'
                    };
                    return icons[level.toLowerCase()] || 'üìù';
                },
                
                searchPayments() {
                    // –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
                },
                
                async exportData(format) {
                    try {
                        const response = await fetch(`/api/export?format=${format}&status=${this.filterStatus}`);
                        
                        if (format === 'csv') {
                            const blob = await response.blob();
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = `payments_${new Date().toISOString().split('T')[0]}.csv`;
                            a.click();
                        } else {
                            const data = await response.json();
                            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = `payments_${new Date().toISOString().split('T')[0]}.json`;
                            a.click();
                        }
                        
                        this.showToast('success', '–≠–∫—Å–ø–æ—Ä—Ç', '–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã');
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ');
                    }
                },
                
                async loadBeneficiaries() {
                    try {
                        const response = await fetch('/api/beneficiaries');
                        const data = await response.json();
                        if (data.success) {
                            this.beneficiaries = data.beneficiaries;
                            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                            this.$nextTick(() => {
                                if (window.lucide) lucide.createIcons();
                            });
                        }
                    } catch (error) {
                        console.error('Failed to load beneficiaries:', error);
                    }
                },
                
                async addBeneficiary() {
                    if (!this.newBeneficiary.card_number || !this.newBeneficiary.card_owner) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                        return;
                    }
                    
                    this.loadingBeneficiary = true;
                    
                    try {
                        const response = await fetch('/api/beneficiaries', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.newBeneficiary)
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            if (data.verified) {
                                this.showToast('success', '–£—Å–ø–µ—Ö!', '–†–µ–∫–≤–∏–∑–∏—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω ‚úì');
                            } else {
                                this.showToast('warning', '–î–æ–±–∞–≤–ª–µ–Ω–æ', '–†–µ–∫–≤–∏–∑–∏—Ç –¥–æ–±–∞–≤–ª–µ–Ω, –Ω–æ –Ω–µ –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É ‚úó');
                            }
                            
                            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                            this.newBeneficiary = { card_number: '', card_owner: '' };
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                            await this.loadBeneficiaries();
                            await this.loadPayments();
                        } else {
                            this.showToast('error', '–û—à–∏–±–∫–∞', data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç');
                        }
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç');
                        console.error('Failed to add beneficiary:', error);
                    } finally {
                        this.loadingBeneficiary = false;
                    }
                },
                
                async toggleBeneficiary(id, isActive) {
                    try {
                        const response = await fetch(`/api/beneficiaries/${id}/toggle`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ is_active: isActive })
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            this.showToast('success', '–£—Å–ø–µ—Ö', isActive ? '–†–µ–∫–≤–∏–∑–∏—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω' : '–†–µ–∫–≤–∏–∑–∏—Ç –æ—Ç–∫–ª—é—á–µ–Ω');
                            await this.loadBeneficiaries();
                        } else {
                            this.showToast('error', '–û—à–∏–±–∫–∞', data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å');
                        }
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å');
                        console.error('Failed to toggle beneficiary:', error);
                    }
                },
                
                async deleteBeneficiary(id) {
                    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–µ–∫–≤–∏–∑–∏—Ç?')) {
                        return;
                    }
                    
                    try {
                        const response = await fetch(`/api/beneficiaries/${id}`, {
                            method: 'DELETE'
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            this.showToast('success', '–£–¥–∞–ª–µ–Ω–æ', '–†–µ–∫–≤–∏–∑–∏—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
                            await this.loadBeneficiaries();
                        } else {
                            this.showToast('error', '–û—à–∏–±–∫–∞', data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç');
                        }
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç');
                        console.error('Failed to delete beneficiary:', error);
                    }
                },
                
                async retestBeneficiary(id, cardNumber, cardOwner) {
                    // –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞
                    if (this.retestingId !== null) {
                        return;
                    }
                    
                    if (!confirm('–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Ω–∞ 110‚ÇΩ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞?')) {
                        return;
                    }
                    
                    this.retestingId = id;
                    this.showToast('info', '–ü—Ä–æ–≤–µ—Ä–∫–∞', '–°–æ–∑–¥–∞—é —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂... –≠—Ç–æ –∑–∞–π–º–µ—Ç ~30 —Å–µ–∫—É–Ω–¥');
                    
                    try {
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), 120000); // 2 –º–∏–Ω—É—Ç—ã —Ç–∞–π–º–∞—É—Ç
                        
                        const response = await fetch('/api/beneficiaries/retest', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                beneficiary_id: id,
                                card_number: cardNumber,
                                card_owner: cardOwner
                            }),
                            signal: controller.signal
                        });
                        
                        clearTimeout(timeoutId);
                        const data = await response.json();
                        
                        if (data.success) {
                            if (data.verified) {
                                this.showToast('success', '–£—Å–ø–µ—Ö!', '–†–µ–∫–≤–∏–∑–∏—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω —É—Å–ø–µ—à–Ω–æ ‚úì');
                            } else {
                                this.showToast('error', '–û—à–∏–±–∫–∞', '–†–µ–∫–≤–∏–∑–∏—Ç –Ω–µ –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É ‚úó');
                            }
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                            await this.loadBeneficiaries();
                            await this.loadPayments();
                        } else {
                            this.showToast('error', '–û—à–∏–±–∫–∞', data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç');
                        }
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç');
                        console.error('Failed to retest beneficiary:', error);
                    } finally {
                        this.retestingId = null;
                    }
                },
                
                async testRequisiteAPI() {
                    this.apiTester.loading = true;
                    this.apiTester.response = null;
                    
                    try {
                        const apiName = this.apiTester.source === 'h2h' ? 'H2H' : 'PayzTeam';
                        this.showToast('info', '–¢–µ—Å—Ç', `–ó–∞–ø—Ä–æ—Å –∫ ${apiName} API...`);
                        
                        // –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ API —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 5001
                        const url = this.apiTester.source === 'h2h' 
                            ? 'http://85.192.56.74:5001/api/test-h2h-requisite'
                            : 'http://85.192.56.74:5001/api/test-payzteam-requisite';
                        
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                amount: parseInt(this.apiTester.amount)
                            })
                        });
                        
                        const data = await response.json();
                        this.apiTester.response = data;
                        
                        if (data.card_number && data.card_owner) {
                            this.showToast('success', '–£—Å–ø–µ—Ö', `${apiName} API –≤–µ—Ä–Ω—É–ª —Ä–µ–∫–≤–∏–∑–∏—Ç—ã`);
                        } else {
                            this.showToast('warning', '–ù–µ—Ç —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤', data.error || `${apiName} API –Ω–µ –≤–µ—Ä–Ω—É–ª —Ä–µ–∫–≤–∏–∑–∏—Ç—ã`);
                        }
                    } catch (error) {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å');
                        console.error('Failed to test API:', error);
                        this.apiTester.response = { error: error.message };
                    } finally {
                        this.apiTester.loading = false;
                    }
                },
                
                copyToClipboard(text) {
                    navigator.clipboard.writeText(text).then(() => {
                        this.showToast('success', '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ', 'JSON —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                    }).catch(() => {
                        this.showToast('error', '–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å');
                    });
                },
                
                copyToClipboard(text) {
                    navigator.clipboard.writeText(text).then(() => {
                        this.showToast('success', '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!', '–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                    });
                },
                
                formatDate(timestamp) {
                    return new Date(timestamp).toLocaleString('ru-RU', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                },
                
                showToast(type, title, message) {
                    const toast = { show: true, type, title, message };
                    this.toasts.push(toast);
                    
                    setTimeout(() => {
                        toast.show = false;
                        setTimeout(() => {
                            const index = this.toasts.indexOf(toast);
                            if (index > -1) this.toasts.splice(index, 1);
                        }, 300);
                    }, 3000);
                }
            }
        }
    </script>
</body>
</html>
