# üöÄ –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ LinkFlow Admin

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
LinkFlow/
‚îú‚îÄ‚îÄ admin/                          # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏ API
‚îÇ   ‚îú‚îÄ‚îÄ admin_panel_db.py          # –ê–¥–º–∏–Ω–∫–∞ (–ø–æ—Ä—Ç 5000)
‚îÇ   ‚îú‚îÄ‚îÄ api_server.py              # API —Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 5001)
‚îÇ   ‚îú‚îÄ‚îÄ database.py                # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ mulenpay.py                # MulenPay –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ linkflow.db                # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
‚îÇ   ‚îú‚îÄ‚îÄ payment_service/           # –°–µ—Ä–≤–∏—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payment_service.py     # Playwright –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ steps/                 # –≠—Ç–∞–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step1_amount.py    # –≠—Ç–∞–ø 1: –≤–≤–æ–¥ —Å—É–º–º—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ step2_form.py      # –≠—Ç–∞–ø 2: –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ h2h_api.py            # H2H API –¥–ª—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payzteam_api.py       # PayzTeam API
‚îÇ   ‚îú‚îÄ‚îÄ templates/                 # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ static/                    # CSS, JS
‚îú‚îÄ‚îÄ bots/                          # Telegram –±–æ—Ç—ã (–Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è –∞–¥–º–∏–Ω–∫–∏)
‚îú‚îÄ‚îÄ run_admin_local.bat            # –ó–∞–ø—É—Å–∫ –¥–ª—è Windows (CMD)
‚îú‚îÄ‚îÄ run_admin_local.ps1            # –ó–∞–ø—É—Å–∫ –¥–ª—è Windows (PowerShell)
‚îî‚îÄ‚îÄ LOCAL_SETUP.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 1. Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
cd admin
pip install -r requirements.txt
```

### 2. Playwright (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞)
```bash
pip install -r requirements_playwright.txt
playwright install chromium
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ BAT —Ñ–∞–π–ª (CMD)
```bash
run_admin_local.bat
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ PowerShell
```powershell
.\run_admin_local.ps1
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –í—Ä—É—á–Ω—É—é (–¥–≤–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)

**–¢–µ—Ä–º–∏–Ω–∞–ª 1 - –ê–¥–º–∏–Ω–∫–∞:**
```bash
cd admin
python admin_panel_db.py
```

**–¢–µ—Ä–º–∏–Ω–∞–ª 2 - API Server:**
```bash
cd admin
python api_server.py
```

## üåê –î–æ—Å—Ç—É–ø

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: http://localhost:5000
- **API Server**: http://localhost:5001

## üìä –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É:

1. –û—Ç–∫—Ä—ã–≤–∞–µ—à—å http://localhost:5000
2. –í–≤–æ–¥–∏—à—å —Å—É–º–º—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000 —Ä—É–±.)
3. –ù–∞–∂–∏–º–∞–µ—à—å "–°–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂"

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

```
–ê–¥–º–∏–Ω–∫–∞ (5000) ‚Üí API Server (5001) ‚Üí PaymentService ‚Üí Playwright
                                    ‚Üì
                              H2H/PayzTeam API (—Ä–µ–∫–≤–∏–∑–∏—Ç—ã)
                                    ‚Üì
                              Multitransfer.ru (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞)
                                    ‚Üì
                              QR-—Å—Å—ã–ª–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã
```

### –≠—Ç–∞–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞:

**–≠—Ç–∞–ø 1** (`step1_amount.py`):
- –í–≤–æ–¥ —Å—É–º–º—ã
- –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã (Uzcard)
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è

**–≠—Ç–∞–ø 2** (`step2_form.py`):
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (–∏–∑ –ë–î)
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–æ—Ç H2H/PayzTeam API)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
- –ü–æ–ª—É—á–µ–Ω–∏–µ QR-—Å—Å—ã–ª–∫–∏

## üîë API Endpoints

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)
```bash
POST http://localhost:5001/api/payment
Content-Type: application/json

{
  "amount": 1000,
  "requisite_api": "auto"  # auto, h2h, payzteam
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –¥–ª—è –±–æ—Ç–∞
```bash
POST http://localhost:5001/api/create-bot-payment/crypto
Content-Type: application/json

{
  "amount": 3000
}
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –±–æ—Ç—ã: `nutrition`, `crypto`, `ai`, `fitvip`

### –°–æ–∑–¥–∞–Ω–∏–µ QR –ø–ª–∞—Ç–µ–∂–∞ (MulenPay)
```bash
POST http://localhost:5001/api/create-qr-payment
Content-Type: application/json

{
  "amount": 3500
}
```

### Health Check
```bash
GET http://localhost:5001/health
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

SQLite –±–∞–∑–∞: `admin/linkflow.db`

**–¢–∞–±–ª–∏—Ü—ã:**
- `payments` - –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- `beneficiaries` - —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
- `sender_data` - –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π
- `settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- `logs` - –ª–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ë–î:
```bash
cd admin
sqlite3 linkflow.db
.tables
SELECT * FROM payments LIMIT 5;
.quit
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
–í—Å–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∏ —É—Ä–æ–≤–Ω—è–º–∏:
- `[INFO]` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `[SUCCESS]` - —É—Å–ø–µ—Ö
- `[WARNING]` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- `[ERROR]` - –æ—à–∏–±–∫–∞
- `[DEBUG]` - –æ—Ç–ª–∞–¥–∫–∞

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã –æ—à–∏–±–æ–∫
–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö Playwright —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤:
```
admin/screenshots/error_*.png
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ API
```bash
curl http://localhost:5001/health
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –≤ —Ç–∞–±–ª–∏—Ü–µ `settings`:
- `min_amount` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ (100)
- `max_amount` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ (120000)
- `api_url` - URL API —Å–µ—Ä–≤–µ—Ä–∞
- `requisite_service` - –∏—Å—Ç–æ—á–Ω–∏–∫ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ (auto/h2h/payzteam)

## üîÑ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤

### Auto (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç H2H API, –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ - PayzTeam API

### H2H API
Liberty.top H2H API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤

### PayzTeam API
PayzTeam API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤

### Database
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `beneficiaries`

## üìù –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

### –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
```bash
python test_create_qr_remote.py
```

### –¢–µ—Å—Ç –≤—Å–µ—Ö –±–æ—Ç–æ–≤
```bash
python test_all_bots_payment.py
```

### –¢–µ—Å—Ç H2H API
```bash
cd admin
python test_h2h_simple.py
```

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ "no such table: beneficiaries"
```bash
cd admin
python -c "import database; database.init_database()"
```

### Playwright –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```bash
pip install playwright
playwright install chromium
```

### –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç
–ò–∑–º–µ–Ω–∏ –ø–æ—Ä—Ç –≤ `admin_panel_db.py` (—Å—Ç—Ä–æ–∫–∞ —Å `app.run(port=5000)`)

### –¢–∞–π–º–∞—É—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
–£–≤–µ–ª–∏—á—å —Ç–∞–π–º–∞—É—Ç—ã –≤ `admin/payment_service/steps/step1_amount.py`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- –í—Å–µ –±–æ—Ç—ã –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–∞–ø–∫—É `bots/` –∏ –Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω–∫–∏
- –ê–¥–º–∏–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ
- –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–æ–≤
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î `linkflow.db`
